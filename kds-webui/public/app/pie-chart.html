<!doctype html>
<html lang='en-GB'>
<head>
    <meta charset='utf-8'>
    <title>Pie-Chart Page</title>
    <script src="scripts/ractive.js"></script>
    <script src="scripts/ractive.single-double-click.js"></script>
    <script src="scripts/livescript.js"></script>
    <script src="scripts/prelude-browser-min.js"></script>
    <script src="scripts/ractive-bootstrap.js"></script>
    <script src="scripts/jquery-1.12.0.min.js"></script>
    <script src="scripts/jQuery.Soap.js"></script>
    <link rel="stylesheet" href="scripts/bootstrap.min.css" >
    <link rel="stylesheet" href="scripts/bootstrap-theme.min.css" >
    <script src="scripts/bootstrap.min.js" ></script>


    <script type="text/ls" src="pie-chart.ls"></script>

</head>
<body style="margin:0px;">
    <h1>Pie-Chart</h1>
    <div id='main-output'></div>
    <script id='main-template' type='text/ractive'>
        <div class="box"><piechart names="Domates,Patates,SoÄŸan,Mantar" values="{{myData}}"/></div>
        {{#each [1,2,3,4,5,6,7,8]:i}}
            <div class="box"><piechart names="Kekik,Peynir,Zeytin,Mahmut" values="{{simulateData(i)}}"/></div>
        {{/each}}
    </script>
    <script id='pie-chart' type='text/ractive'>
        <svg viewBox='0 0 100 180'>
        {{#each getSegments( values ) :i}}
            <g transform='translate(50,50)'>
              <polygon fill='{{ colors[i] }}'
                on-mouseover='set("selected", i)' on-mouseout='set("selected", null)'
                opacity='{{ selected === null ? 1 : (selected === i ? 1 : 0.2) }}' points='{{ getSegmentPoints( ., 20, 50 ) }}'>
            </g>
            <g transform='translate(5,110)' on-mouseover='set("selected", i)' on-mouseout='set("selected", null)'
                opacity='{{ selected === null ? 1 : (selected === i ? 1 : 0.2) }}'>
                <rect transform='translate(0,{{i*10}})' width="5" height="5" style="fill:{{ colors[i] }};stroke-width:0.5;stroke:rgb(0,0,0)" />
                <text transform='translate(10,{{i*10+5}})'  font-size="7">{{columnList[i]}} ({{ .["value"] }})</text>
            </g>
            <g transform='translate(50,58)'>
                {{#if selected === i}}
                    <text text-anchor="middle"  style="font-weight: bold; font-family: monospace; font-size: 1.8em;">{{ .["value"] }}</text>
                {{/if}}
            </g>
        {{/each segments}}
        </svg>
    </script>
    <style>
        .box {
            position: relative;
            width: 15%;
            float: left;
            margin: 1em;
        }
        .box:after {
            display: block;
            content: '';
            padding-bottom: 80%;
        }
    </style>
    <script>
        require("LiveScript").go()
    </script>
</body>
</html>
