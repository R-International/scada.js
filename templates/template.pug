doctype html
//- ------------------------------------------------------------------------
//- IMPORTANT: Above "doctype html" declaration MUST be the very first line.
//- ------------------------------------------------------------------------
include mixins.pug

mixin app
    script(src="js/app.js")

mixin app-loading 
    //- Load app.js with a progress bar. Usage: 
    
        block app 
            +app-loading 
            
        block loading 
            +app-loading-progress 
            
    #dynamic-script
    script
        include:livescript ./load-app.ls 
        
mixin app-loading-progress 
    .row
        .column
            //-p: b#percent
            .ui.progress.teal(id="percentProgress")
                .bar(style="min-width: 0 !important;")
                    .progress

html(lang="en-GB")
    head
        meta(charset="utf-8")
        meta(
            name="viewport"
            content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"
            )
        meta(http-equiv='cache-control' content='no-cache')
        meta(http-equiv='expires' content='0')
        meta(http-equiv='pragma' content='no-cache')
        meta(name="mobile-web-app-capable" content="yes")
        meta(name="google" value="notranslate")

        block icon 
            link(rel="icon" sizes="any" href="images/scadajs.ico")

        block title
            title ScadaJS #{app}

        script.
            window.headStart = Date.now()
            
        //- vendor.js
        script if (typeof module === 'object') {window.module = module; module = undefined;}
        script#vendor(src="js/vendor.js")
        script if (window.module) module = window.module;
        
        //- global css
        link(rel="stylesheet", href="css/vendor.css")
        
        //- rest of head section
        block head-append

    body(ontouchstart)
        block content                
            .ui.centered.grid#content
                .row
                    .column(style="padding-top: 10%")
                        img.ui.small.centered.image(src="images/scadajs-logo-long.svg")

                .row
                    .column 
                        .ui.active.centered.inline.big.text.loader.indeterminate
                            p Loading Application...
                            #timer 
                            
                .row#errorSection(style="display: none")
                    .column 
                        .ui.red.message 
                            h3.ui.header ERROR 
                            pre#errorMessage
                            
                block loading                 

                script
                    include ./estimate.js
        
        script
            include ./error.js

        block app 
            +app
                
        block body-append
            
